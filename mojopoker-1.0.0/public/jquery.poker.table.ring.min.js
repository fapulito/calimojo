(function(c,b,a,d){c.widget("poker.table_ring",c.poker.table,{_create:function(){var e=this,g=e.options,f=e.element;e._super();f.append(e._buildBuy(),c("<div />)").addClass("leave-all").click(function(){g.pokerMain.main("unjoin_ring",{table_id:g.table_id})}));f.find(".header-icon-close").click(function(){g.pokerMain.main("unjoin_ring",{table_id:g.table_id})})},unjoin_ring_res:function(f){var e=this,h=e.options,g=e.element;g.find(".leave-all").hide();g.find(".open-graphic").show()},notify_join_table:function(f){var e=this,h=e.options,g=e.element;e._super(f);if(f.login_id==h.login_id){var i=g.find(".seat"+f.chair);i.append(c("<div />").addClass("menu").append(c("<button />").addClass("get-chips menuitem").html("Get Chips").click(function(){i.children(".menu").fadeToggle("fast");e.tableBuy(f.chair,true)}),c("<button />").addClass("leave-table menuitem").html("Leave Table").click(function(){h.pokerMain.main("unjoin_ring",{table_id:h.table_id,chair:f.chair});i.children(".menu").fadeToggle("fast")})));i.children(".seated-clear").click(function(){var j=i.children(".menu").fadeToggle("fast");clearTimeout(h.menutimer);h.menutimer=setTimeout(function(){j.hide()},5000)});g.find(".leave-all").show();g.find(".open-graphic").hide()}},player_unjoin:function(f){var e=this,h=e.options,g=e.element;this._super(f);var i=g.find(".seat"+f.chair).attr("status","open");i.append(c("<div />").addClass("open-graphic").click(function(){var k=c("#lobby-main").lobby("option","myData.chips");if(k&&h.director_id in k){e.tableBuy(f.chair,false)}else{e._tableMsg("Not enough chips.")}}))},_buildBuy:function(){var g=this,k=g.options,h=g.element,j=c("<div />").addClass("opt-sld").slider({value:(k.table_min+k.table_max)/2,min:k.table_min,max:k.table_max,slide:function(f,m){l.val(m.value)}}),l=c("<input />").addClass("opt-amt").attr({name:"optra",type:"text",value:j.slider("value")});var i=c("<form />").append(c("<div />").addClass("opt-amtl").html("Amount:"),l,j);var e=c("<div />").addClass("table-buy table-mod");return e.append(c("<div />").addClass("opt-head"),c("<div />").addClass("opt-bank").html("My Bankroll:"),c("<div />").addClass("opt-bval"),c("<div />").addClass("opt-rebuy").html("Auto-Rebuy:"),c("<div />").addClass("opt-reval bool").click(function(){var f=c(this);f.toggleClass("on");if(f.hasClass("on")){f.html("On")}else{f.html("Off")}}).click(),i,c("<button />").addClass("modal-ok").html("OK").click(function(){i.submit()}),c("<button />").addClass("modal-cancel").html("Cancel").click(function(){e.hide()}))},tableBuy:function(q,t){var u=this,j=u.options,k=u.element,l=k.find(".table-buy"),s=l.find(".opt-head"),n=l.find(".opt-bval"),i=l.find(".opt-amt"),e=l.find(".opt-sld");var g=c("#lobby-main").lobby("option","myData.chips");var f=g&&j.director_id in g?g[j.director_id]:0;var r=f>j.table_max?j.table_max:f;e.slider("option","max",r);n.html(f);var p=t?"Get Chips":"Buy in";s.html(p);l.find("form").off().submit(function(m){m.preventDefault();var h=l.find(".opt-reval").hasClass("on")?i.val():0;if(t){c("#poker-main").main("table_opts",{auto_rebuy:h});c("#poker-main").main("table_chips",{chips:i.val(),table_id:j.table_id,chair:q})}else{var o={chips:i.val(),table_id:j.table_id,chair:q,auto_rebuy:h};c("#poker-main").main("join_ring",o)}});l.show()},table_chips_res:function(f){var e=this,h=e.options,g=e.element;e._super(f);g.find(".table-buy").hide();if(!f.success){e._tableMsg(f.message)}},join_ring_res:function(f){var e=this,h=e.options,g=e.element;e._super(f);g.find(".table-buy").hide();if(!f.success){e._tableMsg(f.message)}}})})(jQuery,window,document);