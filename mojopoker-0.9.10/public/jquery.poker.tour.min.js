(function(c,b,a,d){c.widget("poker.tour",{options:{heightToWidth:3/4,windowRatio:1/2,windowMin:1/3,windowMax:15/20,pidData:{},tidData:{},colData:{1:["Table","int"],2:["Players","int"],3:["Large","int"],4:["Small","int"],5:["Player","string"],6:["Chips","int"],7:["Rank","int"]}},_create:function(){var e=this,g=e.options,f=e.element;e._setOptions({pokerLobby:c("#poker-lobby"),pokerMain:c("#poker-main")});f.addClass("ui-widget ui-front stacked tour "+g.game_class).attr({"chair-count":g.chair_count,"game-choice":g.game_class}).append(c("<div/>").addClass("header-icon header-icon-resize header-icon-max").click(function(){e._resizeMax(c(this))}),c("<div/>").addClass("header-icon header-icon-close").click(function(){g.pokerMain.main("unwatch_tour",{tour_id:g.tour_id})}),c("<div />").addClass("tour-header"),c("<div />").addClass("tour-logo"),c("<div />").addClass("tour-class"),c("<div />").addClass("tour-buyin"),c("<div />").addClass("tour-state"),c("<div />").addClass("tour-header"),c("<div />").addClass("tour-sum").append(c("<div />").addClass("tour-start"),c("<div />").addClass("tour-end"),c("<div />").addClass("tour-enroll"),c("<div />").addClass("tour-reg").html("Register").hide(),c("<div />").addClass("tour-prizes")),c("<div />").addClass("tour-tables").append(e._buildTable([1,2,3,4])),c("<div />").addClass("tour-detail").append(c("<button />").addClass("tour-observe").html("Observe Table").hide()),c("<div />").addClass("tour-players").append(e._buildTable([5,6,7])));f.resizable({aspectRatio:true,resize:function(h,i){c(this).css("font-size",(i.size.width/40))}});f.draggable({stack:".stacked",stop:function(){var h=c(".stacked").css("z-index");c(this).css("z-index",h+1)},create:function(){var h=c(".stacked").css("z-index");c(this).css("z-index",h+1)},containment:"window"});c.each(g,function(h,i){e._setOption(h,i)});e.resizeBox(g.windowRatio);e.tour_update(g)},_buildTable:function(h){var e=this,i=e.options,g=e.element;var f="";c.each(h,function(l,j){var m=i.colData[j][0];var k=i.colData[j][1];f+='<th data-sort-dir="asc" data-sort="'+k+'">'+m+"</th>"});return c("<div />").addClass("table-box").append(c("<table />").append(c("<thead />").append(c("<tr>").html(f)),c("<tbody />")).stupidtable().bind("aftertablesort",function(k,m){$this=c(this);$this.find("tbody tr:visible:first").trigger("click");var j=$this.find("th");j.find(".arro").remove();var l=m.direction==="asc"?"↑":"↓";j.eq(m.column).append('<span class="arro">'+l+"</span>")}))},tour_update:function(h){var f=this,i=f.options,g=f.element;var e={tourData:function(k){var j=k.entry_fee+k.buy_in;g.find(".tour-header").html(j+" "+k.desc);g.find(".tour-class").html(k.desc);g.find(".tour-buyin").html("Buy-In: "+k.buy_in+" + "+k.entry_fee)},prizes:function(j){var k=g.find(".tour-prizes");c.each(j,function(m,l){k.append(c("<div>").append(c("<span>").html(m+1),c("<span>").html(l)))})},del_plrs:function(j){var k=g.find(".tour-players tbody");c.each(j,function(m,l){delete i.pidData[l];k.children("tr[pid="+l+"]").remove()})},add_plrs:function(j){var k=g.find(".tour-players tbody");c.each(j,function(l,m){i.pidData[l]=m;k.children("tr[pid="+l+"]").remove();k.append(c("<tr>").attr("pid",l).append(c("<td>").html(m.handle),c("<td>").html(m.chips),c("<td>")))})},seat_plrs:function(j){},unseat_plrs:function(j){},end_time:function(k){if(k){var l=(new Date(k*1000+i.epochDiff)).toString().split(/\s/);var j=l[4].split(":");var m=l[1]+" "+l[2]+" "+j[0]+":"+j[1];g.find(".tour-end").html("Ended: "+m)}},start_time:function(k){var m=(new Date(k*1000+i.epochDiff)).toString().split(/\s/);var j=m[4].split(":");var l=m[1]+" "+m[2]+" "+j[0]+":"+j[1];g.find(".tour-start").html("Started: "+l)},state:function(j){g.find(".tour-state").html("Tournament "+i.gameState[j])},enrolled:function(j){g.find(".tour-enroll").html("Enrolled: "+j)}};c.each(h,function(l,j){if(l in e){e[l](j)}})},_destroy:function(){},destroy:function(){},_resizeMin:function(f){var e=this,h=e.options,g=e.element;f.off();e.resizeBox(h.windowMin);f.removeClass("header-icon-min").addClass("header-icon-max").click(function(){e._resizeMax(f)})},_resizeMax:function(f){var e=this,h=e.options,g=e.element;f.off();e.resizeBox(h.windowMax);f.removeClass("header-icon-max").addClass("header-icon-min").click(function(){e._resizeMin(f)})},resizeBox:function(m,n,f){var g=this.options,i=c(b),h=i.width(),j=i.height(),k=h*m,e=k*g.heightToWidth;f=f?f:((h-k)/2);n=n?n:((j-e)/2);this.element.css({position:"absolute",width:(k)+"px",height:(e)+"px",fontSize:(k/40),top:n,left:f})},_setOption:function(f,h){var e=this,i=e.options,g=e.element;i[f]=h}})})(jQuery,window,document);